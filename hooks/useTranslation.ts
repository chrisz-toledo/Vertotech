
import React, { createContext, useState, useContext, useMemo, useCallback } from 'react';
import { useLocalStorage } from './useLocalStorage';

const translations = {
    en: {
        poweredBy: 'powered by',
        openTrash: 'Open Trash',
        dashboard: 'Dashboard',
        employees: 'Employees',
        clients: 'Clients',
        subcontractors: 'Subcontractors',
        'leave-requests': 'Leave Requests',
        jobsites: 'Jobsites',
        planning: 'Planning',
        'time-tracking': 'Time Tracking',
        'extra-work': 'Extra Work',
        invoices: 'Invoices',
        estimates: 'Estimates',
        addEstimate: 'Add Estimate',
        legal: 'Legal',
        addLegalDocument: 'Add Legal Document',
        prices: 'Rates',
        addPriceItem: 'Add Rate',
        payables: 'Payables',
        addBill: 'Add Bill',
        safety: 'Safety',
        payroll: 'Payroll',
        documents: 'Documents',
        inventory: 'Inventory',
        expenses: 'Expenses',
        addExpense: 'Add Expense',
        tools: 'Tools',
        materials: 'Materials',
        addTool: 'Add Tool',
        addMaterial: 'Add Material',
        searchEmployees: 'Search employees...',
        searchClients: 'Search clients...',
        aiSearch: 'AI Search',
        aiSearchPlaceholder: "Search with AI across the app (e.g. 'available carpenters', 'overdue invoices')...",
        clear: 'Clear',
        addEmployee: 'New Employee',
        addClient: 'New Client',
        addJobsite: 'New Jobsite',
        createTicket: 'New Ticket',
        generateInvoice: 'Generate Invoice',
        aiSafetyAnalysis: 'AI Safety Analysis',
        aiSafetyAnalysisDesc: 'Upload a jobsite photo for AI to identify risks and suggest improvements.',
        goToSafety: 'Go to Safety',
        rachyOpinions: "Rachy's Opinions",
        rachyOpinionsDesc: "Get proactive advice on your team's efficiency and profitability.",
        getOpinions: 'Get Opinions',
        assignmentAssistant: 'Assignment Assistant',
        assignmentAssistantDesc: 'Find the best employees for a job based on their skills and ratings.',
        openAssistant: 'Open Assistant',
        activeEmployees: 'Active Employees',
        activeClients: 'Active Clients',
        hoursThisWeek: 'Hours (This Week)',
        hoursByClient: 'Hours by Client (Current Week)',
        noHoursThisWeek: 'No hours logged this week.',
        employeesByTrade: 'Employees by Trade',
        noActiveEmployees: 'No active employees.',
        hoursTrend: 'Hours Trend (Last 4 Weeks)',
        noHoursData: 'No hours data available.',
        todaysCheckIn: "Today's Check-in",
        checkedIn: 'Checked In',
        noCheckinToday: 'No employees have checked in today.',
        morningBriefing: 'Morning Briefing',
        getSummary: 'Get Summary',
        liveStatus: 'Live Status',
        present: 'Present',
        absent: 'Absent',
        checkedOut: 'Checked Out',
        alerts: 'Alerts',
        generateAlerts: 'Generate Alerts',
        generating: 'Generating...',
        noAlerts: 'No alerts found. Everything looks good!',
        alertsDescription: 'AI will analyze your data to find potential risks.',
        last7days: 'last 7 days',
        financialSummary: 'Financial Summary',
        revenue: 'Revenue',
        accountsReceivable: 'Accounts Receivable',
        accountsPayable: 'Accounts Payable',
        operationalStatus: 'Operational Status',
        projects: 'Projects',
        actionItems: 'Action Items',
        pendingTickets: 'Pending Tickets',
        overdueInvoices: 'Overdue Invoices',
        overduePayables: 'Overdue Payables',
        noActionItems: 'No immediate action items found.',
        toolsAttention: 'Tools Needing Attention',
        inProgress: 'In Progress',
        onHold: 'On Hold',
        completed: 'Completed',
        inMaintenance: 'In Maintenance',
        broken: 'Broken',
        noProjects: 'No active projects.',
        noToolsAttention: 'No tools need attention.',
        activeProjects: 'Active Projects',
        projectsAtRisk: 'Projects at Risk',
        budget: 'Budget',
        actual: 'Actual',
        projectHealth: 'Project Health',
        analyzeHealth: 'Analyze Health',
        analyzing: 'Analyzing...',
        notifications: 'Notifications',
        noNotifications: 'No new notifications.',
        markAllRead: 'Mark all as read',
        addToSchedule: 'Add to Schedule',
        optimizeSchedule: 'Optimize with AI',
        aiTools: 'AI Tools',
        blueprintInterpreter: 'Blueprint Interpreter',
        blueprintInterpreterDesc: 'Upload a blueprint and ask questions to get AI-powered analysis.',
        openInterpreter: 'Open Interpreter',
        uploadPlan: 'Upload Blueprint',
        askQuestion: 'Ask a question about the blueprint...',
        analyzePlan: 'Analyze Blueprint',
        purchaseOrders: 'Purchase Orders',
        'purchase-orders': 'Purchase Orders', // for nav
        addPO: 'New Purchase Order',
        cashFlowForecast: 'Cash Flow Forecast',
        cashFlowForecastDesc: 'Use AI to predict cash flow for the next 30, 60, and 90 days.',
        generateForecast: 'Generate Forecast',
        labor: 'Labor',
        miscellaneous: 'Miscellaneous',
        pettyCash: 'Petty Cash',
        'petty-cash': 'Petty Cash', // for nav
        addTransaction: 'Add Transaction',
        currentBalance: 'Current Balance',
        createManualInvoice: 'Create Manual Invoice',
        runPayroll: 'Run Payroll',
        printChecks: 'Print Checks',
        grossPay: 'Gross Pay',
        deductions: 'Deductions',
        netPay: 'Net Pay',
        addDeduction: 'Add Deduction',
        deductionDescription: 'Deduction Description',
        applyToSelected: 'Apply to Selected',
        addSubcontractor: 'New Subcontractor',
        complianceStatus: 'Compliance Status',
        complianceDocuments: 'Compliance Documents',
        trade: 'Trade',
        valid: 'Valid',
        expiresSoon: 'Expires Soon',
        expired: 'Expired',
        bids: 'Bids',
        addBid: 'Add Bid',
        tasks: 'Tasks',
        training: 'Training',
        fleet: 'Fleet',
        generateClientSummary: 'Generate Client Summary',
        addTask: 'Add Task List',
        open: 'Open',
        completed_qc: 'Completed',
        generateQuiz: 'Generate Quiz',
        addVehicle: 'Add Vehicle',
        predictMaintenance: 'Predict Maintenance',
        contracts: 'Contracts',
        balance: 'Balances',
        productivity: 'Productivity',
        analytics: 'Analytics',
        payrollReport: 'Payroll Report',
        clientProfitability: 'Client Profitability',
        jobsiteFinancials: 'Jobsite Financials',
        foremanPerformance: 'Foreman Performance',
        efficiency: 'Efficiency',
        quality: 'Quality',
        unitsPerHour: 'Units/Hour',
        overtimeRatio: 'Overtime Ratio',
        reworkTickets: 'Rework Tickets',
        navigation: 'Navigation',
        quickActions: 'Quick Actions',
        aiAssistants: 'AI Assistants',
        payToTheOrderOf: "PAY TO THE ORDER OF",
        memo: "MEMO",
        signature: "SIGNATURE",
        payStub: "PAY STUB",
        employee: "Employee",
        payDate: "Pay Date",
        description: "Description",
        rate: "Rate",
        earnings: "Earnings",
        regularPay: "Regular Pay",
        overtimePay: "Overtime Pay",
        totalDeductions: "Total Deductions",
        grossPay_table: "GROSS PAY",
        netPay_table: "NET PAY",
        general: 'General',
        people: 'People',
        finance: 'Finance',
        operations: 'Operations',
        createNew: 'Create New',
        addInvoice: 'New Invoice',
        addContract: 'New Contract',
        noClientsFound: 'No Clients to Display',
        addFirstClient: 'Start by adding a new client.',
        newJobsite: 'New Jobsite',
        newInvoice: 'New Invoice',
        newTicket: 'New Ticket',
        financialSettings: 'Financial Settings',
        payrollSettings: 'Payroll Settings',
        payPeriod: 'Pay Period',
        weekly: 'Weekly',
        'bi-weekly': 'Bi-weekly',
        overtimeThreshold: 'Overtime Threshold',
        invoicingSettings: 'Invoicing Settings',
        invoicePrefix: 'Invoice Prefix',
        defaultPaymentTerms: 'Default Payment Terms',
        defaultInvoiceNotes: 'Default Invoice Notes',
        'sales-crm': 'Sales / CRM',
        opportunities: 'Opportunities',
        prospects: 'Prospects',
        addProspect: 'New Prospect',
        addOpportunity: 'New Opportunity',
        lead: 'Lead',
        contacted: 'Contacted',
        proposal_sent: 'Proposal Sent',
        negotiation: 'Negotiation',
        won: 'Won',
        lost: 'Lost',
        hours: "Hours",
        suppliers: "Suppliers",
        addSupplier: "New Supplier",
        registerMovement: "Register Movement",
        requestForQuote: "Request for Quote",
        addQuoteRequest: "New RFQ",
        edit: 'Edit',
        bulkEdit: 'Bulk Edit',
        generateWithAI: 'Generate with AI',
        comments: 'Comments',
        addComment: 'Add Comment',
        'daily-logs': 'Daily Logs',
        dailyProduction: 'Daily Production',
        addProductionLog: 'Add Production Log',
        responsible: 'Responsible',
        createBill: 'Create Supplier Bill',
        billForPO: 'Bill for PO #',
        'project-center': 'Project Center',
        selectProject: 'Select a project',
        financialHealth: 'Financial Health',
        teamOnSiteToday: 'Team on Site Today',
        openTickets: 'Open Tickets',
        recentLogs: 'Recent Logs',
        generateWeeklyReport: 'Generate Weekly Report with AI',
        doubleClickToEdit: 'Double-click to edit',
        filters: 'Filters',
        applyFilters: 'Apply Filters',
        clearFilters: 'Clear Filters',
        saveView: 'Save View',
        viewName: 'View Name',
        'This Week': 'This Week',
        'This Month': 'This Month',
        'Last 30 Days': 'Last 30 Days',
        myDay: 'My Day',
        todaysSchedule: "Today's Schedule",
        myOpenTasks: 'My Open Tasks',
        myAssignedTools: 'My Assigned Tools',
        close: 'Close',
        capturePhoto: 'Capture Photo',
        cancel: 'Cancel',
        yesConfirm: 'Yes, Confirm',
        confirmPayment: 'Confirm Payment',
        saveChanges: 'Save Changes',
        addRate: 'Add Rate',
        confirm: 'Confirm',
        jobsite: 'Jobsite',
        applyChanges: 'Apply Changes',
        settings: 'Settings',
        personalization: 'Personalization',
        documentStyling: 'Document Styling',
        categoriesAndRates: 'Categories & Rates',
        dataManagement: 'Data Management',
        companyInformation: 'Company Information',
        appearance: 'Appearance',
        dangerZone: 'Danger Zone',
        jobRoles: 'Job Roles',
        productivityUnits: 'Productivity Units',
        materialUnits: 'Material Units',
        expenseCategories: 'Expense Categories',
        payableCategories: 'Payable Categories',
        pettyCashCategories: 'Petty Cash Categories',
        streetAddress: 'Street Address',
        buildingType: 'Building Type',
        house: 'House',
        office: 'Office',
        building: 'Building',
        other: 'Other',
        unitSuiteFloor: 'Unit / Suite / Floor',
        city: 'City',
        state: 'State / Province',
        zipCode: 'ZIP / Postal Code',
        country: 'Country',
        checkinEarlySuccess: "Check-in successful at {time}. Your shift starts at {startTime}.",
        checkinSuccess: "Check-in successful.",
        checkoutSuccess: "Check-out successful.",
        foremanMode: "Foreman Mode",
        safetyBriefing: "Safety Briefing",
        acknowledge: "Acknowledge & Clock In",
        acknowledgedAndIn: "Acknowledged. Clocked in.",
        lastScan: "Last Scan",
        // Trash Modal
        recycleBin: "Recycle Bin",
        selectAll: "Select All",
        deletionIn: "Deletion in {days} days",
        clientLabel: "Client",
        jobsiteLabel: "Jobsite",
        trashEmpty: "Trash Empty",
        categoryEmpty: "This category is empty.",
        restore: "Restore",
        delete: "Delete",
        // Employee Form
        jobStatus: "Job Status",
        active: "Active",
        inactive: "Inactive",
        fullName: "Full Name",
        phone1: "Phone 1",
        phone2: "Phone 2",
        employeePhoto: "Employee Photo",
        notApplicable: "Not applicable",
        upload: "Upload",
        camera: "Camera",
        jobTitle: "Job Title",
        selectJob: "Select a job",
        addNewJob: "+ Add New Job...",
        enterNewJob: "Enter new job title",
        save: "Save",
        socialSecurity: "Social Security",
        hourlyPay: "Hourly Pay ($)",
        overtimePayLabel: "Overtime Pay ($)",
        employeeDocs: "Employee Documents",
        docType: "Type",
        certification: "Certification",
        license: "License",
        insurance: "Insurance",
        w9: "W9",
        expirationOptional: "Expiration (Optional)",
        attachDocument: "Attach Document",
        detailedRating: "Detailed Rating",
        specialtyArea: "Specialty (Area of Expertise)",
        specialtyPlaceholder: "e.g., Leadership, Finishing",
        rateSpecialty: "Rate Specialty",
        saveChanges_btn: "Save Changes",
        addEmployee_btn: "Add Employee",
        moveToTrash: "Move to Trash",
        // Client Form
        clientStatus: "Client Status",
        clientType: "Client Type",
        company: "Company",
        individual: "Individual",
        companyName: "Company Name",
        contactPerson: "Contact Person",
        email: "Email",
        mainAddress: "Main Address (Billing)",
        retentionPercentage: "Retention Percentage",
        clientDocs: "Client Documents",
        clientRating: "Client Rating",
        optional: "(Optional)",
        pending: 'Pending',
        approved: 'Approved',
        denied: 'Denied',
        vacation: 'Vacation',
        sick: 'Sick Leave',
        personal: 'Personal',
        unpaid: 'Unpaid',
    },
    es: {
        poweredBy: 'con tecnología de',
        openTrash: 'Abrir Papelera',
        dashboard: 'Resumen',
        employees: 'Empleados',
        clients: 'Clientes',
        subcontractors: 'Subcontratistas',
        'leave-requests': 'Solicitudes de Ausencia',
        jobsites: 'Sitios',
        planning: 'Planificación',
        'time-tracking': 'Control de Horas',
        'extra-work': 'Trabajo Extra',
        invoices: 'Facturas',
        estimates: 'Estimados',
        addEstimate: 'Nuevo Estimado',
        legal: 'Legal',
        addLegalDocument: 'Añadir Documento Legal',
        prices: 'Tarifas',
        addPriceItem: 'Añadir Tarifa',
        payables: 'Cuentas por Pagar',
        addBill: 'Añadir Factura',
        safety: 'Seguridad',
        payroll: 'Nómina',
        documents: 'Documentos',
        inventory: 'Inventario',
        expenses: 'Gastos',
        addExpense: 'Nuevo Gasto',
        tools: 'Herramientas',
        materials: 'Materiales',
        addTool: 'Añadir Herramienta',
        addMaterial: 'Añadir Material',
        searchEmployees: 'Buscar empleados...',
        searchClients: 'Buscar clientes...',
        aiSearch: 'Búsqueda con IA',
        aiSearchPlaceholder: "Buscar con IA en toda la aplicación (ej: 'carpinteros disponibles', 'facturas vencidas')...",
        clear: 'Limpiar',
        addEmployee: 'Nuevo Empleado',
        addClient: 'Nuevo Cliente',
        addJobsite: 'Nuevo Sitio de Trabajo',
        createTicket: 'Nuevo Ticket',
        generateInvoice: 'Generar Factura',
        aiSafetyAnalysis: 'Análisis de Seguridad IA',
        aiSafetyAnalysisDesc: 'Suba una foto de la obra para que la IA identifique riesgos y sugiera mejoras.',
        goToSafety: 'Ir a Seguridad',
        rachyOpinions: 'Opiniones de Rachy',
        rachyOpinionsDesc: 'Obtenga consejos proactivos sobre la eficiencia y rentabilidad de su equipo.',
        getOpinions: 'Obtener Opiniones',
        assignmentAssistant: 'Asistente de Asignación',
        assignmentAssistantDesc: 'Encuentre los mejores empleados para un trabajo basándose en sus habilidades y calificaciones.',
        openAssistant: 'Abrir Asistente',
        activeEmployees: 'Empleados Activos',
        activeClients: 'Clientes Activos',
        hoursThisWeek: 'Horas (Esta Semana)',
        hoursByClient: 'Horas por Cliente (Semana Actual)',
        noHoursThisWeek: 'No hay horas registradas esta semana.',
        employeesByTrade: 'Empleados por Oficio',
        noActiveEmployees: 'No hay empleados activos.',
        hoursTrend: 'Tendencia de Horas (Últimas 4 Semanas)',
        noHoursData: 'No hay datos de horas.',
        todaysCheckIn: 'Check-in de Hoy',
        checkedIn: 'Presente',
        noCheckinToday: 'Ningún empleado ha hecho check-in hoy.',
        morningBriefing: 'Resumen Matutino',
        getSummary: 'Obtener Resumen',
        liveStatus: 'Estado en Vivo',
        present: 'Presente',
        absent: 'Ausente',
        checkedOut: 'Salida',
        alerts: 'Alertas',
        generateAlerts: 'Generar Alertas',
        generating: 'Generando...',
        noAlerts: 'No se encontraron alertas. ¡Todo parece estar en orden!',
        alertsDescription: 'La IA analizará sus datos para encontrar riesgos potenciales.',
        last7days: 'últimos 7 días',
        financialSummary: 'Resumen Financiero',
        revenue: 'Ingresos',
        accountsReceivable: 'Cuentas por Cobrar',
        accountsPayable: 'Cuentas por Pagar',
        operationalStatus: 'Estado Operacional',
        projects: 'Proyectos',
        actionItems: 'Acciones Requeridas',
        pendingTickets: 'Tickets Pendientes',
        overdueInvoices: 'Facturas Vencidas',
        overduePayables: 'Cuentas por Pagar Vencidas',
        noActionItems: 'No se encontraron acciones inmediatas.',
        toolsAttention: 'Herramientas que necesitan atención',
        inProgress: 'En Progreso',
        onHold: 'Suspendido',
        completed: 'Completado',
        inMaintenance: 'En Mantenimiento',
        broken: 'Dañada',
        noProjects: 'No hay proyectos activos.',
        noToolsAttention: 'Ninguna herramienta necesita atención.',
        activeProjects: 'Proyectos Activos',
        projectsAtRisk: 'Proyectos en Riesgo',
        budget: 'Presupuesto',
        actual: 'Real',
        projectHealth: 'Salud del Proyecto',
        analyzeHealth: 'Analizar Salud',
        analyzing: 'Analizando...',
        notifications: 'Notificaciones',
        noNotifications: 'No hay notificaciones nuevas.',
        markAllRead: 'Marcar todas como leídas',
        addToSchedule: 'Añadir a la Planificación',
        optimizeSchedule: 'Optimizar con IA',
        aiTools: 'Herramientas de IA',
        blueprintInterpreter: 'Intérprete de Planos',
        blueprintInterpreterDesc: 'Suba un plano y haga preguntas para obtener un análisis con IA.',
        openInterpreter: 'Abrir Intérprete',
        uploadPlan: 'Subir Plano',
        askQuestion: 'Haga una pregunta sobre el plano...',
        analyzePlan: 'Analizar Plano',
        purchaseOrders: 'Órdenes de Compra',
        'purchase-orders': 'Órdenes de Compra', // for nav
        addPO: 'Nueva Orden de Compra',
        cashFlowForecast: 'Pronóstico de Flujo de Caja',
        cashFlowForecastDesc: 'Use IA para predecir el flujo de caja para los próximos 30, 60 y 90 días.',
        generateForecast: 'Generar Pronóstico',
        labor: 'Mano de Obra',
        miscellaneous: 'Misceláneos',
        pettyCash: 'Caja Chica',
        'petty-cash': 'Caja Chica', // for nav
        addTransaction: 'Añadir Transacción',
        currentBalance: 'Saldo Actual',
        createManualInvoice: 'Crear Factura Manual',
        runPayroll: 'Correr Nómina',
        printChecks: 'Imprimir Cheques',
        grossPay: 'Pago Bruto',
        deductions: 'Deducciones',
        netPay: 'Pago Neto',
        addDeduction: 'Añadir Deducción',
        deductionDescription: 'Descripción de Deducción',
        applyToSelected: 'Aplicar a Seleccionados',
        addSubcontractor: 'Nuevo Subcontratista',
        complianceStatus: 'Estado de Cumplimiento',
        complianceDocuments: 'Documentos de Cumplimiento',
        trade: 'Oficio',
        valid: 'Vigente',
        expiresSoon: 'Por Vencer',
        expired: 'Vencido',
        bids: 'Licitaciones',
        addBid: 'Añadir Licitación',
        tasks: 'Tareas',
        training: 'Capacitación',
        fleet: 'Flota',
        generateClientSummary: 'Generar Resumen para Cliente',
        addTask: 'Añadir Lista de Tareas',
        open: 'Abierto',
        completed_qc: 'Completado',
        generateQuiz: 'Generar Cuestionario',
        addVehicle: 'Añadir Vehículo',
        predictMaintenance: 'Predecir Mantenimiento',
        contracts: 'Contratos',
        balance: 'Saldos',
        productivity: 'Productividad',
        analytics: 'Analíticas',
        payrollReport: 'Reporte de Nómina',
        clientProfitability: 'Rentabilidad por Cliente',
        jobsiteFinancials: 'Finanzas por Sitio',
        foremanPerformance: 'Rendimiento de Capataces',
        efficiency: 'Eficiencia',
        quality: 'Calidad',
        unitsPerHour: 'Unidades/Hora',
        overtimeRatio: 'Ratio de Overtime',
        reworkTickets: 'Tickets de Retrabajo',
        navigation: 'Navegación',
        quickActions: 'Acciones Rápidas',
        aiAssistants: 'Asistentes IA',
        payToTheOrderOf: "PÁGUESE A LA ORDEN DE",
        memo: "MEMO",
        signature: "FIRMA",
        payStub: "TALÓN DE PAGO",
        employee: "Empleado",
        payDate: "Fecha de Pago",
        description: "Descripción",
        rate: "Tarifa",
        earnings: "Ganancias",
        regularPay: "Pago Regular",
        overtimePay: "Pago de Overtime",
        totalDeductions: "Deducciones Totales",
        grossPay_table: "PAGO BRUTO",
        netPay_table: "PAGO NETO",
        general: 'General',
        people: 'Personal',
        finance: 'Finanzas',
        operations: 'Operaciones',
        createNew: 'Crear Nuevo',
        addInvoice: 'Nueva Factura',
        addContract: 'Nuevo Contrato',
        noClientsFound: 'No hay Clientes para Mostrar',
        addFirstClient: 'Comience por añadir un nuevo cliente.',
        newJobsite: 'Nuevo Sitio de Trabajo',
        newInvoice: 'Nueva Factura',
        newTicket: 'Nuevo Ticket',
        financialSettings: 'Ajustes Financieros',
        payrollSettings: 'Ajustes de Nómina',
        payPeriod: 'Período de Pago',
        weekly: 'Semanal',
        'bi-weekly': 'Quincenal',
        overtimeThreshold: 'Horas para Overtime',
        invoicingSettings: 'Ajustes de Facturación',
        invoicePrefix: 'Prefijo de Factura',
        defaultPaymentTerms: 'Términos de Pago por Defecto',
        defaultInvoiceNotes: 'Notas por Defecto en Facturas',
        'sales-crm': 'Ventas / CRM',
        opportunities: 'Oportunidades',
        prospects: 'Prospectos',
        addProspect: 'Nuevo Prospecto',
        addOpportunity: 'Nueva Oportunidad',
        lead: 'Prospecto',
        contacted: 'Contactado',
        proposal_sent: 'Propuesta Enviada',
        negotiation: 'Negociación',
        won: 'Ganada',
        lost: 'Perdida',
        hours: "Horas",
        suppliers: "Proveedores",
        addSupplier: "Nuevo Proveedor",
        registerMovement: "Registrar Movimiento",
        requestForQuote: "Solicitud de Cotización",
        addQuoteRequest: "Nueva Solicitud",
        edit: 'Editar',
        bulkEdit: 'Edición en Lote',
        generateWithAI: 'Generar con IA',
        comments: 'Comentarios',
        addComment: 'Añadir Comentario',
        'daily-logs': 'Bitácora Diaria',
        dailyProduction: 'Producción del Día',
        addProductionLog: 'Añadir Registro de Producción',
        responsible: 'Responsable',
        createBill: 'Crear Factura de Proveedor',
        billForPO: 'Factura para OC #',
        'project-center': 'Centro de Proyectos',
        selectProject: 'Seleccione un proyecto',
        financialHealth: 'Salud Financiera',
        teamOnSiteToday: 'Equipo en Sitio Hoy',
        openTickets: 'Tickets Abiertos',
        recentLogs: 'Bitácoras Recientes',
        generateWeeklyReport: 'Generar Reporte Semanal con IA',
        doubleClickToEdit: 'Doble clic para editar',
        filters: 'Filtros',
        applyFilters: 'Aplicar Filtros',
        clearFilters: 'Limpiar Filtros',
        saveView: 'Guardar Vista',
        viewName: 'Nombre de la Vista',
        'This Week': 'Esta Semana',
        'This Month': 'Este Mes',
        'Last 30 Days': 'Últimos 30 Días',
        myDay: 'Mi Dia',
        todaysSchedule: 'Horario de Hoy',
        myOpenTasks: 'Mis Tareas Pendientes',
        myAssignedTools: 'Mis Herramientas Asignadas',
        close: 'Cerrar',
        capturePhoto: 'Capturar Foto',
        cancel: 'Cancelar',
        yesConfirm: 'Sí, Confirmar',
        confirmPayment: 'Confirmar Pago',
        saveChanges: 'Guardar Cambios',
        addRate: 'Añadir Tarifa',
        confirm: 'Confirmar',
        jobsite: 'Sitio de Trabajo',
        applyChanges: 'Aplicar Cambios',
        settings: 'Ajustes',
        personalization: 'Personalización',
        documentStyling: 'Estilo de Documentos',
        categoriesAndRates: 'Categorías y Tarifas',
        dataManagement: 'Gestión de Datos',
        companyInformation: 'Información de la Compañía',
        appearance: 'Apariencia',
        dangerZone: 'Zona de Peligro',
        jobRoles: 'Oficios',
        productivityUnits: 'Unidades de Productividad',
        materialUnits: 'Unidades de Materiales',
        expenseCategories: 'Categorías de Gastos',
        payableCategories: 'Categorías por Pagar',
        pettyCashCategories: 'Categorías de Caja Chica',
        streetAddress: 'Dirección (Calle y Número)',
        buildingType: 'Tipo de Edificio',
        house: 'Casa',
        office: 'Oficina',
        building: 'Edificio',
        other: 'Otro',
        unitSuiteFloor: 'Unidad / Suite / Piso',
        city: 'Ciudad',
        state: 'Estado / Provincia',
        zipCode: 'Código Postal',
        country: 'País',
        checkinEarlySuccess: "Check-in exitoso a las {time}. Su turno comienza a las {startTime}.",
        checkinSuccess: "Check-in exitoso.",
        checkoutSuccess: "Check-out exitoso.",
        foremanMode: "Modo Capataz",
        safetyBriefing: "Instrucción de Seguridad",
        acknowledge: "Confirmar y Marcar Entrada",
        acknowledgedAndIn: "Confirmado. Entrada marcada.",
        lastScan: "Último Escaneo",
        // Trash Modal
        recycleBin: "Papelera de Reciclaje",
        selectAll: "Seleccionar Todo",
        deletionIn: "Eliminación en {days} días",
        clientLabel: "Cliente",
        jobsiteLabel: "Sitio de Trabajo",
        trashEmpty: "Papelera Vacía",
        categoryEmpty: "Esta categoría está vacía.",
        restore: "Restaurar",
        delete: "Eliminar",
        // Employee Form
        jobStatus: "Estado Laboral",
        active: "Activo",
        inactive: "Inactivo",
        fullName: "Nombre Completo",
        phone1: "Teléfono 1",
        phone2: "Teléfono 2",
        employeePhoto: "Foto del Empleado",
        notApplicable: "No aplicable",
        upload: "Subir",
        camera: "Cámara",
        jobTitle: "Oficio / Labor",
        selectJob: "Seleccione un oficio",
        addNewJob: "+ Añadir Nuevo Oficio...",
        enterNewJob: "Ingrese nuevo oficio",
        save: "Guardar",
        socialSecurity: "Seguro Social",
        hourlyPay: "Pago por Hora ($)",
        overtimePayLabel: "Pago de Overtime ($)",
        employeeDocs: "Documentos del Empleado",
        docType: "Tipo",
        certification: "Certificación",
        license: "Licencia",
        insurance: "Seguro",
        w9: "W9",
        expirationOptional: "Vencimiento (Opcional)",
        attachDocument: "Adjuntar Documento",
        detailedRating: "Calificación Detallada",
        specialtyArea: "Especialidad (Área de Expertise)",
        specialtyPlaceholder: "Ej: Liderazgo, Acabados",
        rateSpecialty: "Calificar Especialidad",
        saveChanges_btn: "Guardar Cambios",
        addEmployee_btn: "Añadir Empleado",
        moveToTrash: "Mover a la Papelera",
        // Client Form
        clientStatus: "Estado del Cliente",
        clientType: "Tipo de Cliente",
        company: "Compañía",
        individual: "Individual",
        companyName: "Nombre de la Compañía",
        contactPerson: "Persona de Contacto",
        email: "Correo Electrónico",
        mainAddress: "Dirección Principal (Facturación)",
        retentionPercentage: "Porcentaje de Retención",
        clientDocs: "Documentos del Cliente",
        clientRating: "Calificación del Cliente",
        optional: "(Opcional)",
        pending: 'Pendiente',
        approved: 'Aprobado',
        denied: 'Denegado',
        vacation: 'Vacaciones',
        sick: 'Enfermedad',
        personal: 'Personal',
        unpaid: 'Sin Sueldo',
    }
};

type Language = 'en' | 'es';
type TranslationKeys = keyof typeof translations.es & keyof typeof translations.en;

interface LanguageContextType {
    language: Language;
    setLanguage: (language: Language) => void;
    t: (key: TranslationKeys, params?: { [key: string]: string | number }) => string;
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export const LanguageProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
    const [language, setLanguage] = useLocalStorage<Language>('language', 'es');

    const t = useCallback((key: TranslationKeys, params?: { [key: string]: string | number }): string => {
        let translation = translations[language][key] || key;
        if (params) {
            Object.keys(params).forEach(paramKey => {
                translation = translation.replace(`{${paramKey}}`, String(params[paramKey]));
            });
        }
        return translation;
    }, [language]);

    const value = useMemo(() => ({
        language,
        setLanguage,
        t
    }), [language, t, setLanguage]);

    return React.createElement(LanguageContext.Provider, { value }, children);
};

export const useTranslation = (): LanguageContextType => {
    const context = useContext(LanguageContext);
    if (context === undefined) {
        throw new Error('useTranslation must be used within a LanguageProvider');
    }
    return context;
};